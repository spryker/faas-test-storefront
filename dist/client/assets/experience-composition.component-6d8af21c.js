import{B as h,r as d,j as p,l as c,m as S,p as m,y as s,f as v,q as $,u as f,_ as r,g as o,v as u,h as g,w as C,x as R,S as b,L as x,o as L}from"./index-74abacf3.js";import{o as l}from"./observe.decorator-62a61e42.js";import{C as j}from"./component.mixin-ae2cf780.js";import{t as w}from"./state-804e6978.js";import{l as B}from"./layout.styles-3e06a114.js";import"./screen-c0aae3c9.js";var a;let i=(a=class extends j(){constructor(){super(),this.uid="",this.uid$=new h(this.uid),this.route="",this.route$=new h(this.route),this.experienceService=d(C,null),this.registryService=d(R),this.ssrAwaiter=d(b,null),this.hasSSR=!1,this.isHydrated=!1,this.layoutBuilder=d(x),this.components$=p([this.uid$,this.route$]).pipe(c(([e,t],y)=>{var n;return y>0&&(this.isHydrated=!0),((n=this.experienceService)==null?void 0:n.getComponent({uid:e,route:t}))||L({})}),S(e=>(e==null?void 0:e.components)??[])),this.hasSSR=!!this.renderRoot}isEmpty(){return!this.renderRoot.querySelector(":not(style)")}shouldRenderChildren(){return!!this.renderRoot&&!this.isEmpty()&&!m&&!this.isHydrated}hydrateOnDemand(){this.isHydrated||(this.isHydrated=!0,this.requestUpdate())}render(){return s`
      ${v(this.components$,e=>this.shouldRenderChildren()?s`${[...this.renderRoot.children]}`:e?s`${$(e,t=>t.id,t=>s`${this.registryService.resolveTemplate(t.type,t.id,this.getLayoutClasses(t))} `)}
              ${this.addInlineStyles(e)}`:s``,()=>s`Loading...`)}
    `}addInlineStyles(e){if(!e)return s``;const t=this.layoutBuilder.collectStyles(e);return t!==""?s`${f(`<style>${t}</style>`)}`:s``}getLayoutClasses(e){var t;if(!!((t=e.options)!=null&&t.data))return this.layoutBuilder.getLayoutClasses(e.options.data)}},(()=>{a.styles=B})(),a);r([w(),o("design:type",Array)],i.prototype,"components",void 0);r([u(),o("design:type",Object)],i.prototype,"uid",void 0);r([l(),o("design:type",Object)],i.prototype,"uid$",void 0);r([u(),o("design:type",Object)],i.prototype,"route",void 0);r([l(),o("design:type",Object)],i.prototype,"route$",void 0);i=r([g(),o("design:paramtypes",[])],i);export{i as ExperienceCompositionComponent};
