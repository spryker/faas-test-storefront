{"version":3,"file":"product.controller.828cf3a5.js","sources":["../../../node_modules/@spryker-oryx/product/src/controllers/product.controller.js"],"sourcesContent":["import { ContextController } from '@spryker-oryx/core';\nimport { resolve } from '@spryker-oryx/injector';\nimport { ObserveController } from '@spryker-oryx/utilities/lit-rxjs';\nimport { identity, of, startWith, switchMap } from 'rxjs';\nimport { ProductService } from '../services';\n/**\n * Controls product components by providing easy access to the\n * product data based on the context where the component is used.\n */\nexport class ProductController {\n    constructor(host, include = []) {\n        this.host = host;\n        this.include = include;\n        this.productService = resolve(ProductService, null);\n        // TODO: fix property assigning outside of constructor, it doesn't work in the storybook now\n        this.observe = new ObserveController(host);\n        this.context = new ContextController(host);\n    }\n    getProduct() {\n        return this.observe.get('product').pipe(switchMap((product) => {\n            if (product) {\n                return of(product);\n            }\n            return this.context\n                .get(\"sku\" /* ProductContext.SKU */, this.observe.get('sku'))\n                .pipe(switchMap((sku, index) => {\n                if (!sku) {\n                    return of(null);\n                }\n                return (this.productService\n                    ?.get({ sku, include: this.include })\n                    .pipe(index ? startWith(null) : identity) ?? of(null));\n            }));\n        }));\n    }\n}\n//# sourceMappingURL=product.controller.js.map"],"names":["ProductController","host","include","resolve","ProductService","ObserveController","ContextController","switchMap","product","of","sku","index","_b","_a","startWith","identity"],"mappings":"sLASO,MAAMA,CAAkB,CAC3B,YAAYC,EAAMC,EAAU,GAAI,CAC5B,KAAK,KAAOD,EACZ,KAAK,QAAUC,EACf,KAAK,eAAiBC,EAAQC,EAAgB,IAAI,EAElD,KAAK,QAAU,IAAIC,EAAkBJ,CAAI,EACzC,KAAK,QAAU,IAAIK,EAAkBL,CAAI,CAC5C,CACD,YAAa,CACT,OAAO,KAAK,QAAQ,IAAI,SAAS,EAAE,KAAKM,EAAWC,GAC3CA,EACOC,EAAGD,CAAO,EAEd,KAAK,QACP,IAAI,MAAgC,KAAK,QAAQ,IAAI,KAAK,CAAC,EAC3D,KAAKD,EAAU,CAACG,EAAKC,IAAU,SAChC,OAAKD,GAGGE,GAAAC,EAAA,KAAK,iBAAL,YAAAA,EACF,IAAI,CAAE,IAAAH,EAAK,QAAS,KAAK,OAAO,GACjC,KAAKC,EAAQG,EAAU,IAAI,EAAIC,KAF5B,KAAAH,EAEyCH,EAAG,IAAI,EAJ7CA,EAAG,IAAI,CAKrB,CAAA,CAAC,CACL,CAAC,CACL,CACL"}