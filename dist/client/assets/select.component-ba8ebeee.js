import{y as h,K as d,d as u,_ as e,v as o,g as i}from"./index-4d2c92b7.js";import{S as f}from"./searchbox.controller-e0fbc498.js";import"./typeahead.styles-f3f9a55e.js";import"./searchbox.styles-887a8527.js";import"./common-0ee98dc0.js";import{g as l}from"./getControl-ea6b3b29.js";import"./popover.component-907eb365.js";import{T as y}from"./typeahead.component-38617a9f.js";import"./typeahead.model-c998e806.js";import"./input.styles-6d634215.js";import{F as g}from"./input.component-77513b1c.js";import{b as m}from"./select.styles-a779e65c.js";import"./popover.model-91d12e3a.js";import"./screen-c0aae3c9.js";import"./query.util-00243645.js";import"./popover.controller-b201d380.js";class v{constructor(t){this.host=t,this.initialized=!1,this.host.addController(this),this.onUpdate=this.onUpdate.bind(this),this.onFocus=this.onFocus.bind(this)}hostConnected(){this.host.addEventListener("change",this.onUpdate),this.host.addEventListener("mousedown",this.onFocus),this.host.addEventListener("focusin",this.onFocus)}hostDisconnected(){this.host.removeEventListener("change",this.onUpdate),this.host.removeEventListener("mousedown",this.onFocus),this.host.removeEventListener("focusin",this.onFocus)}hostUpdated(){this.host.toggleAttribute("filterSelect",this.selectFilteringEnabled),this.onUpdate()}render(){return h`${d(!!this.host.filterStrategy,()=>h`<input filterInput />`)}`}onFocus(){this.selectFilteringEnabled&&this.filterControl.focus()}onUpdate(){this.selectFilteringEnabled&&(this.setPlaceholder(),this.setFilterValue(),this.initialized=!0)}setPlaceholder(){const t=this.options.length&&this.options[0].text||"";this.filterControl.setAttribute("placeholder",t)}setFilterValue(){if(this.initialized&&this.host.isEmpty&&!!this.filterControl.value)return;const t=this.control.value,r=t?Array.from(this.options).find(n=>n.value===t):void 0;this.filterControl.value=r?.text||""}get selectFilteringEnabled(){return!!this.host.filterStrategy&&this.control instanceof HTMLSelectElement}get control(){return l(this.host)}get options(){return this.control.querySelectorAll("option")}get filterControl(){return this.host.renderRoot.querySelector("[filterInput]")}}class S{constructor(t){this.host=t,this.options=[],this.host.addController(this)}hostUpdated(){this.initSelect(),this.observeSelect()}initSelect(){const t=l(this.host);t instanceof HTMLSelectElement?this.reflectSelect(t):t.toggleAttribute("readonly",this.host.filterStrategy===void 0||this.host.filterStrategy==="")}reflectSelect(t){const r=Array.from(t.options).filter(n=>n.value!=="").map(n=>{n.hidden=!0;const a={value:n.value},p=n.textContent?.trim();return p!==""&&p!==n.value&&(a.text=p),n.selected&&(a.selected=!0),a});JSON.stringify(r)!==JSON.stringify(this.options)&&(this.options=r,this.reflectOptions()),this.host.isEmpty=this.host.isEmpty&&this.host.hasAttribute("filterselect")||!this.host.isLoading&&this.options.length===0}reflectOptions(){this.clearOptions(),this.options.forEach(t=>{const r=`<oryx-option value='${t.value}' ${t.selected?"selected":""} slot="option">${t.text??t.value}</oryx-option>`;this.host.insertAdjacentHTML("beforeend",r)})}clearOptions(){this.host.querySelectorAll("oryx-option").forEach(t=>t.remove())}observeSelect(){this.mutationObserver?.disconnect(),this.mutationObserver=new MutationObserver(()=>{this.host.requestUpdate()}),this.mutationObserver.observe(l(this.host),{childList:!0,subtree:!0,attributeFilter:["selected"]})}hostDisconnected(){this.mutationObserver?.disconnect()}}class s extends u{constructor(){super(...arguments),this.suffixIcon="dropdown",this.searchIconPosition="NONE",this.clearIconAppearance="HOVER",this.selectController=new S(this),this.selectFilterController=new v(this),this.typeaheadController=new y(this,{showOnFocus:!1}),this.searchController=new f(this),this.formControlController=new g(this)}static{this.styles=m}setValue(t){const r=l(this);r.value!==t&&(r.value=t,r.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})))}render(){return h`
      ${this.formControlController.render({before:this.renderPrefix(),after:this.searchController.renderSuffix()})}
      ${this.typeaheadController.renderPopover()}
    `}updated(){this.clearIconPosition=this.allowEmptyValue?"SUFFIX":"NONE"}renderPrefix(){return h`${this.searchController.renderPrefix()}${this.selectFilterController.render()}`}get allowEmptyValue(){const t=l(this);return t instanceof HTMLInputElement||t.options?.[0]?.value===""}}e([o({type:Boolean}),i("design:type",Boolean)],s.prototype,"filter",void 0);e([o(),i("design:type",String)],s.prototype,"filterStrategy",void 0);e([o({type:Boolean}),i("design:type",Boolean)],s.prototype,"isLoading",void 0);e([o({type:Boolean}),i("design:type",Boolean)],s.prototype,"isEmpty",void 0);e([o(),i("design:type",String)],s.prototype,"emptyMessage",void 0);e([o({type:Boolean}),i("design:type",Boolean)],s.prototype,"hasError",void 0);e([o(),i("design:type",String)],s.prototype,"label",void 0);e([o(),i("design:type",String)],s.prototype,"errorMessage",void 0);e([o(),i("design:type",String)],s.prototype,"prefixIcon",void 0);e([o({type:Boolean}),i("design:type",Boolean)],s.prototype,"prefixFill",void 0);e([o(),i("design:type",String)],s.prototype,"suffixIcon",void 0);e([o({type:Boolean}),i("design:type",Boolean)],s.prototype,"suffixFill",void 0);e([o(),i("design:type",String)],s.prototype,"searchIcon",void 0);e([o(),i("design:type",String)],s.prototype,"searchIconPosition",void 0);e([o(),i("design:type",String)],s.prototype,"clearIcon",void 0);e([o(),i("design:type",String)],s.prototype,"clearIconPosition",void 0);e([o(),i("design:type",String)],s.prototype,"clearIconAppearance",void 0);export{s as SelectComponent};
