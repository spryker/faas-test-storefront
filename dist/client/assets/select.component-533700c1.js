import{y as h,K as f,d as y,_ as o,v as i,g as s}from"./index-41c5945f.js";import{S as g}from"./searchbox.controller-5f002bd8.js";import"./typeahead.styles-97be0c04.js";import"./searchbox.styles-7e993ee0.js";import"./common-0ee98dc0.js";import{g as l}from"./getControl-bdad11f5.js";import"./popover.component-c449afef.js";import{T as m}from"./typeahead.component-81369a14.js";import"./typeahead.model-c998e806.js";import"./input.styles-dce2c601.js";import{F as v}from"./input.component-729fa045.js";import{b as S}from"./select.styles-5fc4c6b3.js";import"./popover.model-91d12e3a.js";import"./screen-c0aae3c9.js";import"./query.util-87342f84.js";import"./popover.controller-82a090e4.js";class b{constructor(t){this.host=t,this.initialized=!1,this.host.addController(this),this.onUpdate=this.onUpdate.bind(this),this.onFocus=this.onFocus.bind(this)}hostConnected(){this.host.addEventListener("change",this.onUpdate),this.host.addEventListener("mousedown",this.onFocus),this.host.addEventListener("focusin",this.onFocus)}hostDisconnected(){this.host.removeEventListener("change",this.onUpdate),this.host.removeEventListener("mousedown",this.onFocus),this.host.removeEventListener("focusin",this.onFocus)}hostUpdated(){this.host.toggleAttribute("filterSelect",this.selectFilteringEnabled),this.onUpdate()}render(){return h`${f(!!this.host.filterStrategy,()=>h`<input filterInput />`)}`}onFocus(){this.selectFilteringEnabled&&this.filterControl.focus()}onUpdate(){this.selectFilteringEnabled&&(this.setPlaceholder(),this.setFilterValue(),this.initialized=!0)}setPlaceholder(){const t=this.options.length&&this.options[0].text||"";this.filterControl.setAttribute("placeholder",t)}setFilterValue(){if(this.initialized&&this.host.isEmpty&&!!this.filterControl.value)return;const t=this.control.value,r=t?Array.from(this.options).find(n=>n.value===t):void 0;this.filterControl.value=(r==null?void 0:r.text)||""}get selectFilteringEnabled(){return!!this.host.filterStrategy&&this.control instanceof HTMLSelectElement}get control(){return l(this.host)}get options(){return this.control.querySelectorAll("option")}get filterControl(){return this.host.renderRoot.querySelector("[filterInput]")}}class E{constructor(t){this.host=t,this.options=[],this.host.addController(this)}hostUpdated(){this.initSelect(),this.observeSelect()}initSelect(){const t=l(this.host);t instanceof HTMLSelectElement?this.reflectSelect(t):t.toggleAttribute("readonly",this.host.filterStrategy===void 0||this.host.filterStrategy==="")}reflectSelect(t){const r=Array.from(t.options).filter(n=>n.value!=="").map(n=>{var d;n.hidden=!0;const a={value:n.value},p=(d=n.textContent)==null?void 0:d.trim();return p!==""&&p!==n.value&&(a.text=p),n.selected&&(a.selected=!0),a});JSON.stringify(r)!==JSON.stringify(this.options)&&(this.options=r,this.reflectOptions()),this.host.isEmpty=this.host.isEmpty&&this.host.hasAttribute("filterselect")||!this.host.isLoading&&this.options.length===0}reflectOptions(){this.clearOptions(),this.options.forEach(t=>{const r=`<oryx-option value='${t.value}' ${t.selected?"selected":""} slot="option">${t.text??t.value}</oryx-option>`;this.host.insertAdjacentHTML("beforeend",r)})}clearOptions(){this.host.querySelectorAll("oryx-option").forEach(t=>t.remove())}observeSelect(){var t;(t=this.mutationObserver)==null||t.disconnect(),this.mutationObserver=new MutationObserver(()=>{this.host.requestUpdate()}),this.mutationObserver.observe(l(this.host),{childList:!0,subtree:!0,attributeFilter:["selected"]})}hostDisconnected(){var t;(t=this.mutationObserver)==null||t.disconnect()}}const c=class extends y{constructor(){super(...arguments),this.suffixIcon="dropdown",this.searchIconPosition="NONE",this.clearIconAppearance="HOVER",this.selectController=new E(this),this.selectFilterController=new b(this),this.typeaheadController=new m(this,{showOnFocus:!1}),this.searchController=new g(this),this.formControlController=new v(this)}setValue(t){const r=l(this);r.value!==t&&(r.value=t,r.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})))}render(){return h`
      ${this.formControlController.render({before:this.renderPrefix(),after:this.searchController.renderSuffix()})}
      ${this.typeaheadController.renderPopover()}
    `}updated(){this.clearIconPosition=this.allowEmptyValue?"SUFFIX":"NONE"}renderPrefix(){return h`${this.searchController.renderPrefix()}${this.selectFilterController.render()}`}get allowEmptyValue(){var r,n;const t=l(this);return t instanceof HTMLInputElement||((n=(r=t.options)==null?void 0:r[0])==null?void 0:n.value)===""}};let e=c;(()=>{c.styles=S})();o([i({type:Boolean}),s("design:type",Boolean)],e.prototype,"filter",void 0);o([i(),s("design:type",String)],e.prototype,"filterStrategy",void 0);o([i({type:Boolean}),s("design:type",Boolean)],e.prototype,"isLoading",void 0);o([i({type:Boolean}),s("design:type",Boolean)],e.prototype,"isEmpty",void 0);o([i(),s("design:type",String)],e.prototype,"emptyMessage",void 0);o([i({type:Boolean}),s("design:type",Boolean)],e.prototype,"hasError",void 0);o([i(),s("design:type",String)],e.prototype,"label",void 0);o([i(),s("design:type",String)],e.prototype,"errorMessage",void 0);o([i(),s("design:type",String)],e.prototype,"prefixIcon",void 0);o([i({type:Boolean}),s("design:type",Boolean)],e.prototype,"prefixFill",void 0);o([i(),s("design:type",String)],e.prototype,"suffixIcon",void 0);o([i({type:Boolean}),s("design:type",Boolean)],e.prototype,"suffixFill",void 0);o([i(),s("design:type",String)],e.prototype,"searchIcon",void 0);o([i(),s("design:type",String)],e.prototype,"searchIconPosition",void 0);o([i(),s("design:type",String)],e.prototype,"clearIcon",void 0);o([i(),s("design:type",String)],e.prototype,"clearIconPosition",void 0);o([i(),s("design:type",String)],e.prototype,"clearIconAppearance",void 0);export{e as SelectComponent};
