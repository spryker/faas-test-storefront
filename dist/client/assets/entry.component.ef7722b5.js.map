{"version":3,"file":"entry.component.ef7722b5.js","sources":["../../../node_modules/@spryker-oryx/cart/entry/src/entry.component.js"],"sourcesContent":["import { __decorate, __metadata } from \"tslib\";\nimport { ContextController } from '@spryker-oryx/core';\nimport { ComponentMixin, ContentController } from '@spryker-oryx/experience';\nimport { asyncValue, subscribe } from '@spryker-oryx/utilities/lit-rxjs';\nimport { html } from 'lit';\nimport { when } from 'lit/directives/when.js';\nimport { BehaviorSubject, combineLatest, map, merge, Subject, take, tap, } from 'rxjs';\nimport { REMOVE_EVENT } from './entry.model';\nimport { baseStyles, styles } from './styles';\nexport class CartEntryComponent extends ComponentMixin() {\n    constructor() {\n        super(...arguments);\n        this.context = new ContextController(this);\n        this.options$ = new ContentController(this).getOptions();\n        this.triggerConfirmationRequired$ = new BehaviorSubject(false);\n        this.confirmation$ = combineLatest([\n            this.triggerConfirmationRequired$,\n            this.options$,\n        ]).pipe(map(([confirmationRequired, entry]) => ({ confirmationRequired, entry })));\n        this.triggerShowOptions$ = new Subject();\n        this.showOptions$ = merge(this.triggerShowOptions$, this.options$.pipe(take(1), map(({ defaultExpandedOptions }) => !!defaultExpandedOptions)));\n        this.sku$ = this.options$.pipe(tap(({ sku }) => {\n            this.context.provide(\"sku\" /* ProductContext.SKU */, sku);\n        }));\n    }\n    toggleOptions(e) {\n        this.triggerShowOptions$.next(e.detail.state);\n    }\n    dispatchRemoveEvent() {\n        this.dispatchEvent(new CustomEvent(REMOVE_EVENT, { bubbles: true, composed: true }));\n    }\n    onQuantityChange(e, isInstant) {\n        if (e.detail.quantity === 0) {\n            e.stopPropagation();\n            if (isInstant) {\n                this.dispatchRemoveEvent();\n                return;\n            }\n            this.triggerConfirmationRequired$.next(true);\n        }\n    }\n    onRemove(instant) {\n        if (instant) {\n            this.dispatchRemoveEvent();\n            this.triggerConfirmationRequired$.next(false);\n            return;\n        }\n        this.triggerConfirmationRequired$.next(true);\n    }\n    onCancelRemoving() {\n        this.triggerConfirmationRequired$.next(false);\n    }\n    render() {\n        return html `${asyncValue(this.options$, (entry) => {\n            const { hidePreview, silentRemove, selectedProductOptions } = entry;\n            const hasOptions = !!selectedProductOptions?.length;\n            return html `\n        ${asyncValue(this.confirmation$, ({ confirmationRequired, entry }) => {\n                if (entry.readonly) {\n                    return html ``;\n                }\n                return html `${when(confirmationRequired, () => html `\n              <cart-entry-confirmation\n                .options=${entry}\n                @remove=${() => this.onRemove(entry.silentRemove || confirmationRequired)}\n                @cancel=${this.onCancelRemoving}\n              ></cart-entry-confirmation>\n            `, () => html `\n              <oryx-icon-button>\n                <button\n                  @click=${() => this.onRemove(entry.silentRemove || confirmationRequired)}\n                  aria-label=\"remove\"\n                >\n                  <oryx-icon\n                    .type=${entry.removeButtonIcon ?? 'close'}\n                  ></oryx-icon>\n                </button>\n              </oryx-icon-button>\n            `)}`;\n            })}\n\n        <div class=\"entry\">\n          ${when(!hidePreview, () => html `\n              <product-media\n                .options=${{\n                containerSize: \"thumbnail\" /* ProductMediaContainerSize.Thumbnail */,\n            }}\n              ></product-media>\n            `)}\n\n          <section>\n            <cart-entry-content\n              .options=${entry}\n              ?disabled=${asyncValue(this.triggerConfirmationRequired$)}\n              @submit=${(e) => this.onQuantityChange(e, !!silentRemove)}\n            ></cart-entry-content>\n\n            ${when(hasOptions, () => html `\n                  <cart-entry-options\n                    .options=${entry}\n                    ?show-options=${asyncValue(this.showOptions$)}\n                    @toggle=${this.toggleOptions}\n                  ></cart-entry-options>\n                `)}\n          </section>\n        </div>\n\n        <cart-entry-totals .options=${entry}></cart-entry-totals>\n      `;\n        })}`;\n    }\n}\nCartEntryComponent.styles = [baseStyles, styles];\n__decorate([\n    subscribe(),\n    __metadata(\"design:type\", Object)\n], CartEntryComponent.prototype, \"sku$\", void 0);\n//# sourceMappingURL=entry.component.js.map"],"names":["CartEntryComponent","ComponentMixin","ContextController","ContentController","BehaviorSubject","combineLatest","map","confirmationRequired","entry","Subject","merge","take","defaultExpandedOptions","tap","sku","e","REMOVE_EVENT","isInstant","instant","html","asyncValue","hidePreview","silentRemove","selectedProductOptions","hasOptions","when","_a","baseStyles","styles","__decorate","subscribe","__metadata"],"mappings":"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"}